#include <sourcemod>
#include <sdktools>	
#include <cstrike>
#include <sdkhooks>
#include <clientprefs>

#define MAP_COUNT 2

// Global handle
Handle  	g_Reload_Delay;

Database 	g_db = null;

char g_maps[MAP_COUNT][] = {
	"strafes",
	"ski2"
};

#include "include/db.sp"
#include "include/displays.sp"

// SETUP
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

public void OnPluginStart() {

	// ConVar
	g_Reload_Delay     = CreateConVar("trick_gxd_top_display_delay",  "600.0", "Delay for reload top");
	AutoExecConfig(true, "trick_gxd_top_display");
	
	// DataBase
	db_connect(g_db == null ? true : false);

	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////	

	// Timers
	CreateTimer(GetConVarFloat(g_Reload_Delay), timer_reload_displays, _, TIMER_REPEAT);
}

//ACTION
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
public Action timer_reload_displays(Handle t) {
	top_update();
}

//ETC
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
public void OnConfigsExecuted() {
	db_connect(g_db == null ? true : false);
}